class Sleep{constructor(){this.timeout_id=null,this.promise=null,this.reject_fn=null}sleep(a){const{promise:b,resolve:c,reject:d}=Promise.withResolvers();return this.promise=b,this.reject_fn=d,this.timeout_id=setTimeout(c,a),this.promise}cancel(){this.timeout_id&&(clearTimeout(this.timeout_id),this.timeout_id=null,this.reject_fn&&this.reject_fn(new Error("Sleep canceled")))}}const containers={control:null,history:null,main:null,easter_egg:null},stacks={a:null,b:null},dialogs={menu:null},_size_stacks=["medium_items_size","compact_items_size","tiny_items_size"],_config={allow_anim:+localStorage.getItem("allow_anim")==1 ? 1 : 0,size_stacks:+localStorage.getItem("size_stacks")||0,time_delay:+localStorage.getItem("time_delay")||1400},_colors=["teal","emerald","green","lime","yellow","amber","orange","red"],__easter_eggs=["Outstandingn't project!","Oh! I see...","Yei! It's ordered.","Have a view-tiful day!","Born2bepushed","What next? So long?","Also try ./errors.sh","Also try ./stadistics.sh","Also try ./test.sh","'Push' your LIMITS!!!","Plus ultraaa!!!","Without leaks?","SegFault, no random message founded.","werodrig tool by viewer."];function config_get(a){return _config[a]}function config_set(a,b){_config[a]=b,localStorage.setItem(a,b)}const cmd_s=async a=>{let b=a.children;2>b.length||(a.insertBefore(b[1],b[0]),animate_translateY(b[0],"down-to-up"),await animate_translateY(b[1],"up-to-down"))};async function cmd_p(a,b,c){0===a.children.length||(b.insertBefore(a.children[0],b.firstChild),animate_translateY(Array.from(b.children).slice(1),"up-to-down"),animate_translateX(b.children[0],c),await animate_translateY(a.children,"down-to-up"))}async function cmd_r(a){if(!(2>a.children.length)){const b=a.children[0];a.appendChild(b),animate_translateY(Array.from(a.children).slice(0,-1),"down-to-up"),await animate_translateY(b,"up-to-down",a.children.length-1)}}async function cmd_rr(a){const b=a.children.length;if(!(2>b)){const c=a.children[b-1];a.insertBefore(c,a.children[0]),animate_translateY(Array.from(a.children).slice(1),"up-to-down"),await animate_translateY(c,"down-to-up",b-1)}}const _cmds=new Map([["sa",()=>cmd_s(stacks.a)],["sb",()=>cmd_s(stacks.b)],["ss",async()=>{cmd_s(stacks.a),await cmd_s(stacks.b)}],["pa",()=>cmd_p(stacks.b,stacks.a,"rigth-to-left")],["pb",()=>cmd_p(stacks.a,stacks.b,"left-to-rigth")],["ra",()=>cmd_r(stacks.a)],["rb",()=>cmd_r(stacks.b)],["rr",async()=>{cmd_r(stacks.a),await cmd_r(stacks.b)}],["rra",()=>cmd_rr(stacks.a)],["rrb",()=>cmd_rr(stacks.b)],["rrr",async()=>{cmd_rr(stacks.a),await cmd_rr(stacks.b)}]]),_cmds_reverse=new Map([["pa",()=>_cmds.get("pb")()],["pb",()=>_cmds.get("pa")()],["ra",()=>_cmds.get("rra")()],["rb",()=>_cmds.get("rrb")()],["rr",()=>_cmds.get("rrr")()],["rra",()=>_cmds.get("ra")()],["rrb",()=>_cmds.get("rb")()],["rrr",()=>_cmds.get("rr")()]]);function cmd_exec(a,b=!1){return b&&_cmds_reverse.has(a)?_cmds_reverse.get(a)():_cmds.has(a)?_cmds.get(a)():void 0}const _timer=new Sleep;let history_index=0,is_playing=!1,req_pause=!1,_last_focused=null,_first_run=!0;var controls={start:null,reset:null,prev:null,next:null,menu:null};function _ctrl_unfocus(a){controls[a]&&(_last_focused=null,controls[a].classList.remove("focused"))}function _ctrl_focus(a){controls[a]&&(_ctrl_unfocus(_last_focused),_last_focused=a,controls[a].classList.add("focused"))}function _ctrls_disable(a,b){for(const c of a)controls[c]&&(controls[c].disabled=b)}function _update_history_index(a){containers.history.children[history_index]&&containers.history.children[history_index].classList.remove("current"),history_index+=a;containers.history.children[history_index]&&(containers.history.children[history_index].classList.add("current"),containers.history.children[history_index].scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}function _on_end_next(){controls.prev.disabled=!(0<history_index);history_index<moves.length||_ctrls_disable(["start","next"],!0)}function _ond_end_prev(){controls.next.disabled=!(history_index<moves.length);0<history_index||_ctrls_disable(["prev"],!0)}async function ctrl_start(){if(req_pause||dialogs.menu.open)return;if(is_playing)return req_pause=!0,_timer.cancel(),void(controls.start.disabled=!0);if(history_index>moves.length-1)return;for(_ctrl_focus("start"),is_playing=!0,controls.start.classList.remove("ctrl_start-play"),controls.start.classList.add("ctrl_start-pause"),_ctrls_disable(["prev","next"],!0);history_index<moves.length&&!req_pause;){try{await _timer.sleep(config_get("time_delay"))}catch(a){break}_update_history_index(1),await cmd_exec(moves[history_index-1])}if(_ctrls_disable(["start","prev","next"],!1),controls.start.classList.remove("ctrl_start-pause"),controls.start.classList.add("ctrl_start-play"),is_playing=!1,req_pause=!1,_on_end_next(),!_first_run||history_index!=moves.length)return;if(_first_run=!1,0!=stacks.b.children.length)return;let a=-Infinity;for(const b of stacks.a.children){const c=parseInt(b.querySelector("div").textContent,10);if(c<a)return;a=c}const b=Math.floor(Math.random()*__easter_eggs.length);containers.easter_egg.innerText=__easter_eggs[b],containers.easter_egg.classList.add("text-green-300")}async function ctrl_next(){is_playing||req_pause||dialogs.menu.open||history_index>moves.length-1||(_ctrl_focus("next"),req_pause=!0,_ctrls_disable(["start","prev","next"],!0),_update_history_index(1),await cmd_exec(moves[history_index-1]),_ctrls_disable(["start","prev","next"],!1),req_pause=!1,_on_end_next())}async function ctrl_prev(){is_playing||req_pause||dialogs.menu.open||0>=history_index||(_ctrl_focus("prev"),req_pause=!0,_ctrls_disable(["start","prev","next"],!0),_update_history_index(-1),await cmd_exec(moves[history_index],!0),_ctrls_disable(["start","prev","next"],!1),req_pause=!1,_ond_end_prev())}function ctrl_reset(){_ctrl_focus("reset"),location.reload()}function ctrl_menu(){is_playing||req_pause||(_ctrl_focus("menu"),dialogs.menu.open?dialogs.menu.close():dialogs.menu.showModal())}const _keydowns=new Map([["KeyR","reset"],["Space","start"],["ArrowLeft","prev"],["ArrowRight","next"],["KeyM","menu"]]);function event_keydown(a){if(_keydowns.has(a.code)){const b=controls[_keydowns.get(a.code)];b.click()}}async function animate(a){return new Promise(b=>0==config_get("allow_anim")?void b():void anime({...a,complete:b}))}async function animate_appear(a){return animate({targets:a,opacity:{value:[0,1],duration:600,easing:"easeInOutSine"},translateX:{value:["-10%","0"],duration:600,easing:"spring(1, 80, 10, 0)"},delay:anime.stagger(50)})}async function animate_translateX(a,b="left-to-rigth"){return animate({targets:a,translateX:[0,"left-to-rigth"==b?"-100%":"100%"],easing:"easeInOutExpo",direction:"reverse",duration:400})}async function animate_translateY(a,b="up-to-down",c=1){let d=100*c;return"up-to-down"==b&&(d=-d),animate({targets:a,translateY:[0,`${d}%`],direction:"reverse",easing:"easeInOutExpo",duration:400})}function create_item_stack(a,b,c){let d=document.createElement("li"),e=document.createElement("div");return d.className=`stack_item_wrapper`,e.className=`stack_item bg-${_colors.at(b)}-700`,e.style.width=`${20+10*c}%`,e.innerText=a,d.appendChild(e),d}function create_item_history(a){let b=document.createElement("li");return b.innerText=a,b}function data_load_err(){alert("Error loading data")}async function data_load_ok(){for(const a of Object.keys(containers))if(containers[a]=document.getElementById(`container_${a}`),null===containers[a])return console.error(new Error(`Fatal Error: missing container ${a}`));for(const a of Object.keys(controls))if(controls[a]=containers.control.querySelector(`#ctrl_${a}`),null===controls[a])return console.error(new Error(`Fatal Error: missing ctrl ${a}`));for(const a of Object.keys(stacks))if(stacks[a]=containers.main.querySelector(`#stack_${a}`),null===stacks[a])return console.error(new Error(`Fatal Error: missing stack ${a}`));for(const a of Object.keys(dialogs))if(dialogs[a]=document.getElementById(`dialog_${a}`),null===dialogs[a])return console.error(new Error(`Fatal Error: missing dialog ${a}`));containers.control.style.display="flex",containers.main.style.display="flex";const a=containers.history;for(let b=0;b<moves.length;b++)_cmds.has(moves.at(b))&&a.appendChild(create_item_history(moves.at(b)));0<a.children.length&&(a.children[0].classList.add("current"),a.children[0].scrollIntoView({block:"center",inline:"center",behavior:"smooth"}));const b=dialogs.menu.querySelector("#config_allow_anim"),c=dialogs.menu.querySelector(`#config_size_stacks_${config_get("size_stacks")}`),d=dialogs.menu.querySelector("#config_time_delay");if(!b||!c||!d)return console.error(new Error(`Fatal Error: missing inputs`));b.checked=1==config_get("allow_anim"),c.checked=!0,containers.main.classList.add(_size_stacks.at(config_get("size_stacks"))),d.value=config_get("time_delay"),d.nextElementSibling.value=`${config_get("time_delay")}ms`;for(let a,b=0;b<numbers.length;b++)a=create_item_stack(numbers[b].number,numbers[b].color,numbers[b].weight),stacks.a.appendChild(a);await animate_appear(stacks.a.children),_ctrls_disable(["start","next","reset","menu"],!1),document.addEventListener("keydown",event_keydown)}function on_change_stack_size(a){containers.main.classList.remove(_size_stacks.at(config_get("size_stacks"))),config_set("size_stacks",a),containers.main.classList.add(_size_stacks.at(+a||0))}function on_change_allow_anim(a){const b=a?1:0;config_set("allow_anim",b)}function on_change_time_delay(a){let b=a;(2450<a||50>a)&&(b=1000),config_set("time_delay",b)}